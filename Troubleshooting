# Troubleshooting

Common problems and solutions observed during lab build.

## Suricata service fails to start
- Symptom: Suricata crashes with "failed to find interface eth0" or YAML parse errors.
- Fix:
  - Confirm interface names with `ip a`.
  - Edit `/etc/suricata/suricata.yaml` af-packet section to use correct interfaces and proper indentation (2 spaces per level).
  - Run `sudo suricata -T -c /etc/suricata/suricata.yaml` to locate YAML errors.

## No alerts despite traffic visible in tcpdump
- Confirm Suricata is sniffing the correct interfaces (`journalctl -u suricata`).
- Confirm rule files are present and `rule-files:` lists `local.rules`.
- Add a simple test rule `alert icmp any any -> any any ...` and restart suricata.

## Permission denied errors (logs/tailing)
- Use `sudo` for commands like `tail -f /var/log/suricata/fast.log`.
